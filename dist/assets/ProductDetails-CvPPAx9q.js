import{j as e,h as k,i as B,k as U,l as X,m as W,n as G,o as J,N as K,S as o,p as V,q as Y,r as Z,_ as x,b as ee,s as se}from"./index-DI8Lomad.js";import{H as N,F as te,$ as re}from"./index-Ci1zFXAS.js";import{r as l}from"./react-BbaTowL1.js";import{M as ne}from"./index-D6AXLMh1.js";import{y as ie,u as oe}from"./redux-BaaShjVO.js";import{r as S}from"./features-D8KFa1sJ.js";import"./firebase-DTxrvWAw.js";const F=({value:r=0})=>{const{Ratings:c}=N({IconFilled:e.jsx(k,{}),IconOutline:e.jsx(B,{}),value:r,styles:{fontSize:"1.75rem",color:"coral",justifyContent:"flex-start"}});return e.jsx(e.Fragment,{children:e.jsx(c,{})})},we=()=>{var v,R,b,y,C;const r=U(),c=ie(),{user:n}=oe(t=>t.userReducer),{isLoading:a,isError:I,data:s}=X(r.id),d=W(r.id),[L,m]=l.useState(!1),[u,p]=l.useState(1),[j,g]=l.useState(""),h=l.useRef(null),[D,w]=l.useState(!1),[O]=G(),[_]=J(),A=()=>{var t,i;if(((t=s==null?void 0:s.product)==null?void 0:t.stock)===u)return x.error(`${(i=s==null?void 0:s.product)==null?void 0:i.stock} available only`);p(z=>z+1)},P=()=>{p(t=>t-1)},M=t=>{if(t.stock<1)return x.error("Out Of Stock");c(ee(t)),x.success("Added to cart")};if(I)return e.jsx(K,{to:"/404"});const T=()=>{var t;(t=h.current)==null||t.showModal()},{Ratings:E,rating:H,setRating:$}=N({IconFilled:e.jsx(k,{}),IconOutline:e.jsx(se,{}),value:0,selectable:!0,styles:{fontSize:"1.75rem",color:"coral",justifyContent:"flex-start"}}),f=()=>{var t;(t=h.current)==null||t.close(),$(0),g("")},Q=async t=>{t.preventDefault(),w(!0),f();const i=await O({comment:j,rating:H,userId:n==null?void 0:n._id,productId:r.id});w(!1),S(i,null,"")},q=async t=>{const i=await _({reviewId:t,userId:n==null?void 0:n._id});S(i,null,"")};return e.jsxs("div",{className:"product-details",children:[a?e.jsx(le,{}):e.jsxs("main",{children:[e.jsxs("section",{children:[e.jsx(te,{showThumbnails:!0,showNav:!1,onClick:()=>m(!0),images:((v=s==null?void 0:s.product)==null?void 0:v.photos.map(t=>t.url))||[]}),L&&e.jsx(re,{NextButton:ae,PrevButton:de,setIsOpen:m,images:((R=s==null?void 0:s.product)==null?void 0:R.photos.map(t=>t.url))||[]})]}),e.jsxs("section",{children:[e.jsx("code",{children:s==null?void 0:s.product.category}),e.jsx("h1",{children:s==null?void 0:s.product.name}),e.jsxs("em",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsx(F,{value:((b=s==null?void 0:s.product)==null?void 0:b.ratings)||0}),"(",(y=s==null?void 0:s.product)==null?void 0:y.numOfReviews," reviews)"]}),e.jsxs("h3",{children:["$",s==null?void 0:s.product.price]}),e.jsxs("article",{children:[e.jsxs("div",{children:[e.jsx("button",{onClick:P,children:"-"}),e.jsx("span",{children:u}),e.jsx("button",{onClick:A,children:"+"})]}),(s==null?void 0:s.product)&&e.jsx("button",{onClick:()=>{var t,i;return M({productId:s.product._id,name:s.product.name,price:s.product.price,stock:s.product.stock,quantity:u,photo:((i=(t=s.product.photos)==null?void 0:t[0])==null?void 0:i.url)||""})},children:"Add to Cart"})]}),e.jsx("p",{children:s==null?void 0:s.product.description})]})]}),e.jsxs("dialog",{ref:h,className:"review-dialog",children:[e.jsx("button",{onClick:f,children:"X"}),e.jsx("h2",{children:"Write a Review"}),e.jsxs("form",{onSubmit:Q,children:[e.jsx("textarea",{value:j,onChange:t=>g(t.target.value),placeholder:"Review..."}),e.jsx(E,{}),e.jsx("button",{disabled:D,type:"submit",children:"Submit"})]})]}),e.jsxs("section",{children:[e.jsxs("article",{children:[e.jsx("h2",{children:"Reviews"}),d.isLoading?null:n&&e.jsx("button",{onClick:T,children:e.jsx(ne,{})})]}),e.jsx("div",{style:{display:"flex",gap:"2rem",overflowX:"auto",padding:"2rem"},children:d.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(o,{width:"45rem",length:5}),e.jsx(o,{width:"45rem",length:5}),e.jsx(o,{width:"45rem",length:5}),e.jsx(o,{width:"45rem",length:5})]}):(C=d.data)==null?void 0:C.reviews.map(t=>e.jsx(ce,{handleDeleteReview:q,userId:n==null?void 0:n._id,review:t},t._id))})]})]})},ce=({review:r,userId:c,handleDeleteReview:n})=>{const a=r.user.name.charAt(0).toUpperCase();return e.jsxs("div",{className:"review",children:[e.jsx(F,{value:r.rating}),e.jsx("p",{children:r.comment}),e.jsxs("div",{children:[r.user.photo?e.jsx("img",{src:r.user.photo,alt:"User",className:"review-user-photo"}):e.jsx("div",{className:"review-user-initial",children:a}),e.jsx("small",{children:r.user.name})]}),c===r.user._id&&e.jsx("button",{onClick:()=>n(r._id),children:e.jsx(V,{})})]})},le=()=>e.jsxs("div",{style:{display:"flex",gap:"2rem",border:"1px solid #f1f1f1",height:"80vh"},children:[e.jsx("section",{style:{width:"100%",height:"100%"},children:e.jsx(o,{width:"100%",containerHeight:"100%",height:"100%",length:1})}),e.jsxs("section",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"4rem",padding:"2rem"},children:[e.jsx(o,{width:"40%",length:3}),e.jsx(o,{width:"50%",length:4}),e.jsx(o,{width:"100%",length:2}),e.jsx(o,{width:"100%",length:10})]})]}),ae=({onClick:r})=>e.jsx("button",{onClick:r,className:"carousel-btn",children:e.jsx(Y,{})}),de=({onClick:r})=>e.jsx("button",{onClick:r,className:"carousel-btn",children:e.jsx(Z,{})});export{we as default};
