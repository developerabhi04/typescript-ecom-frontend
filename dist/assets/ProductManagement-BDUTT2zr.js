import{k as q,A as L,Z as H,$ as M,l as R,j as e,N as T,S as $,t as Q}from"./index-DI8Lomad.js";import{r as o}from"./react-BbaTowL1.js";import{A as X}from"./AdminSidebar-DnWKxm2A.js";import{u as Z}from"./redux-BaaShjVO.js";import{t as z,r as U}from"./features-D8KFa1sJ.js";import{A as B}from"./index-Ci1zFXAS.js";import"./firebase-DTxrvWAw.js";import"./index-67BwcfBo.js";import"./index-D6AXLMh1.js";const re=()=>{const{id:P}=q(),h=L(),[k]=H(),[C]=M(),{user:i}=Z(r=>r.userReducer),{data:t,isLoading:D,isError:w}=R(P||"");console.log(t);const{price:x,photos:I,name:g,description:A,stock:c,category:E}=(t==null?void 0:t.product)||{photos:[],category:"",name:"",stock:0,price:0,description:""},[j,f]=o.useState(!1),[n,v]=o.useState(g),[d,b]=o.useState(A),[l,y]=o.useState(x),[p,S]=o.useState(c),[u,N]=o.useState(E),a=B("multiple",10,5),F=async r=>{r.preventDefault(),f(!0);try{const s=new FormData;if(n&&s.set("name",n),d&&s.set("description",d),l&&s.set("price",l.toString()),p!==void 0&&s.set("stock",p.toString()),u&&s.set("category",u),a.file&&a.file.length>0&&a.file.forEach(m=>{s.append("photos",m)}),i&&(t!=null&&t.product)){const m=await k({formData:s,userId:i._id,productId:t.product._id});U(m,h,"/admin/products")}}catch(s){console.log(s)}finally{f(!1)}},_=async()=>{if(i&&(t!=null&&t.product)){const r=await C({userId:i._id,productId:t.product._id});U(r,h,"/admin/products")}};return o.useEffect(()=>{t&&(v(t.product.name),b(t.product.description),y(t.product.price),S(t.product.stock),N(t.product.category))},[t]),w?e.jsx(T,{to:"/404"}):e.jsxs("div",{className:"admin-container",children:[e.jsx(X,{}),e.jsx("main",{className:"management-section",children:D?e.jsx($,{length:20}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{children:[e.jsxs("strong",{children:["ID - ",t==null?void 0:t.product._id," "]}),e.jsx("img",{src:z(I[0].url),alt:"product"}),e.jsx("p",{children:g}),c>0?e.jsxs("span",{className:"green",children:[c," Available"]}):e.jsx("span",{className:"red",children:"Not Available"}),e.jsxs("h3",{children:["$",x]})]}),e.jsxs("article",{children:[e.jsx("button",{className:"product-delete-btn",onClick:_,children:e.jsx(Q,{})}),e.jsxs("form",{action:"",onSubmit:F,children:[e.jsx("h2",{children:"Update Product"}),e.jsxs("div",{children:[e.jsx("label",{children:"Name"}),e.jsx("input",{required:!0,type:"text",placeholder:"Name",value:n,onChange:r=>v(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{required:!0,placeholder:"Description",value:d,onChange:r=>b(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Price"}),e.jsx("input",{required:!0,type:"number",placeholder:"Price",value:l,onChange:r=>y(Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Stock"}),e.jsx("input",{required:!0,type:"number",placeholder:"Stock",value:p,onChange:r=>S(Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx("input",{type:"text",placeholder:"eg. laptop, camera etc",value:u,onChange:r=>N(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Photos"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:a.changeHandler})]}),a.error&&e.jsx("p",{children:a.error}),a.preview&&e.jsx("div",{style:{display:"flex",gap:"1rem",overflowX:"auto"},children:a.preview.map((r,s)=>e.jsx("img",{style:{width:100,height:100,objectFit:"cover"},src:r,alt:"New Image"},s))}),e.jsx("button",{disabled:j,type:"submit",children:j?"Updating product...":"Update"})]})]})]})})]})};export{re as default};
