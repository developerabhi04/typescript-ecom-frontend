import{G as q,j as e,L as f,t as E,v as j,w as N,x as m,y as x,b as C,z as S}from"./index-DI8Lomad.js";import{r}from"./react-BbaTowL1.js";import{t as z}from"./features-D8KFa1sJ.js";import{y as R,u as D}from"./redux-BaaShjVO.js";import"./firebase-DTxrvWAw.js";function H(t){return q({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8.6 1c1.6.1 3.1.9 4.2 2 1.3 1.4 2 3.1 2 5.1 0 1.6-.6 3.1-1.6 4.4-1 1.2-2.4 2.1-4 2.4-1.6.3-3.2.1-4.6-.7-1.4-.8-2.5-2-3.1-3.5C.9 9.2.8 7.5 1.3 6c.5-1.6 1.4-2.9 2.8-3.8C5.4 1.3 7 .9 8.6 1zm.5 12.9c1.3-.3 2.5-1 3.4-2.1.8-1.1 1.3-2.4 1.2-3.8 0-1.6-.6-3.2-1.7-4.3-1-1-2.2-1.6-3.6-1.7-1.3-.1-2.7.2-3.8 1-1.1.8-1.9 1.9-2.3 3.3-.4 1.3-.4 2.7.2 4 .6 1.3 1.5 2.3 2.7 3 1.2.7 2.6.9 3.9.6zM7.9 7.5L10.3 5l.7.7-2.4 2.5 2.4 2.5-.7.7-2.4-2.5-2.4 2.5-.7-.7 2.4-2.5-2.4-2.5.7-.7 2.4 2.5z"},child:[]}]})(t)}const I=({cartItem:t,incrementHandler:n,decrementHandler:i,removeHandler:l})=>{const{photo:d,productId:c,name:a,price:o,quantity:u}=t;return e.jsxs("div",{className:"cart-item",children:[e.jsx("img",{src:z(d),alt:a}),e.jsxs("article",{children:[e.jsx(f,{to:`/product/${c}`,children:a}),e.jsxs("span",{children:["₹",o]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>i(t),children:"-"}),e.jsx("p",{children:u}),e.jsx("button",{onClick:()=>n(t),children:"+"})]}),e.jsx("button",{onClick:()=>l(c),children:e.jsx(E,{})})]})},G=()=>{const t=R(),{cartItems:n,subtotal:i,tax:l,total:d,shippingCharges:c,discount:a}=D(s=>s.cartReducer),[o,u]=r.useState(""),[g,p]=r.useState(!1),v=s=>{s.quantity>=s.stock||t(C({...s,quantity:s.quantity+1}))},y=s=>{s.quantity<=1||t(C({...s,quantity:s.quantity-1}))},k=s=>{t(S(s))};return r.useEffect(()=>{const{token:s,cancel:h}=j.CancelToken.source(),T=setTimeout(()=>{j.get(`${N}/api/v1/payment/discount?coupon=${o}`,{cancelToken:s}).then(b=>{t(m(b.data.discount)),p(!0),t(x())}).catch(()=>{t(m(0)),p(!1),t(x())})},1e3);return()=>{clearTimeout(T),h(),p(!1)}},[o,t]),r.useEffect(()=>{t(x())},[n,t]),e.jsxs("div",{className:"cart",children:[e.jsx("main",{children:n.length>0?n.map((s,h)=>e.jsx(I,{cartItem:s,incrementHandler:v,decrementHandler:y,removeHandler:k},h)):e.jsx("h1",{children:"No Items Added"})}),n.length>0?e.jsxs("aside",{children:[e.jsxs("p",{children:["Subtotal: ₹",i]}),e.jsxs("p",{children:["Shipping: ₹",c]}),e.jsxs("p",{children:["Tax: ₹",l]}),e.jsxs("p",{children:["Discount:",e.jsxs("em",{children:[" - ₹",a]})]}),e.jsx("p",{children:e.jsxs("b",{children:["Total: ₹",d]})}),e.jsx("input",{type:"text",placeholder:"Coupon Code",value:o,onChange:s=>u(s.target.value)}),o&&(g?e.jsxs("span",{className:"green",children:["₹",a," off using the",e.jsx("code",{children:o})]}):e.jsxs("span",{className:"red",children:["Invalid Coupon code ",e.jsx(H,{})]})),n.length>0&&e.jsx(f,{to:"/shipping",children:"Checkout"})]}):""]})};export{G as default};
